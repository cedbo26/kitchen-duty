<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#2d5a27">
    <meta name="description" content="Planning de nettoyage cuisine - Colocation">
    <title>ğŸ³ KitchenDuty</title>
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ³</text></svg>">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ³ KitchenDuty</h1>
            <p class="subtitle">Semaine <span id="weekNumber"></span></p>
        </header>

        <main>
            <!-- Current duty -->
            <section class="current-duty">
                <p class="label">C'est le tour de</p>
                <div class="current-person" id="currentPerson"></div>
                <button class="btn-done" id="btnDone">âœ“ Marquer comme fait</button>
                <button class="btn-undo" id="btnUndo" style="display:none;">â†© Annuler</button>
            </section>

            <!-- Checklist -->
            <section class="checklist">
                <h2>âœ… Checklist</h2>
                <ul id="checklistItems">
                    <li><label><input type="checkbox" data-task="poubelle"> Poubelle (cartons et compartiments)</label></li>
                    <li><label><input type="checkbox" data-task="plaques"> Nettoyer les plaques</label></li>
                    <li><label><input type="checkbox" data-task="table"> Table</label></li>
                    <li><label><input type="checkbox" data-task="evier"> Ã‰vier</label></li>
                    <li><label><input type="checkbox" data-task="machine"> Vider la machine</label></li>
                    <li><label><input type="checkbox" data-task="sol"> Faire le sol</label></li>
                    <li><label><input type="checkbox" data-task="sacs"> Check des sacs poubelle</label></li>
                    <li><label><input type="checkbox" data-task="four"> Four</label></li>
                </ul>
                <p class="checklist-progress"><span id="checklistCount">0</span>/8 complÃ©tÃ©</p>
            </section>

            <!-- Swap section -->
            <section class="swap-section">
                <button class="btn-swap" id="btnSwapToggle">ğŸ”„ Proposer un Ã©change</button>
                <div class="swap-modal" id="swapModal">
                    <p>Ã‰changer avec :</p>
                    <div class="swap-options" id="swapOptions"></div>
                    <button class="btn-cancel" id="btnCancelSwap">Annuler</button>
                </div>
            </section>

            <!-- Schedule -->
            <section class="schedule">
                <h2>ğŸ“… Prochaines semaines</h2>
                <ul id="scheduleList"></ul>
            </section>

            <!-- History -->
            <section class="history">
                <h2>ğŸ“œ Historique</h2>
                <ul id="historyList"></ul>
            </section>

            <!-- Calendar export -->
            <section class="export">
                <button class="btn-export" id="btnExport">ğŸ“† Ajouter Ã  mon calendrier</button>
            </section>
        </main>

        <footer>
            <p>Coloc Crew ğŸ </p>
            <button class="btn-install" id="btnInstall" style="display:none;">ğŸ“² Installer l'app</button>
        </footer>
    </div>

    <!-- Firebase CDN (compat) -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

    <!-- Firebase Initialization -->
    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyDV6kbHMSlfPN2DVMrZip1i8wr9kpj5BYQ",
            authDomain: "kitchen-duty-75864.firebaseapp.com",
            databaseURL: "https://kitchen-duty-75864-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "kitchen-duty-75864",
            storageBucket: "kitchen-duty-75864.firebasestorage.app",
            messagingSenderId: "419676527246",
            appId: "1:419676527246:web:f98693d276ae868a1747df",
            measurementId: "G-G70G8F8K89"
        };

        try {
            firebase.initializeApp(firebaseConfig);
            const kdDb = firebase.database();
            window.kdDb = kdDb;
            console.log('Firebase initialized successfully');
        } catch (error) {
            console.warn('Firebase initialization failed, falling back to localStorage only', error);
            window.kdDb = null;
        }
    </script>

    <script src="app.js"></script>
</body>
</html>
